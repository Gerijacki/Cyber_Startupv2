import nmap

# Función para escanear la red y obtener información de los dispositivos
def scan_network(subnet):
    nm = nmap.PortScanner()
    nm.scan(hosts=f'{subnet}.0/24', arguments='-sn')  # Escanear la red para encontrar dispositivos activos

    for host in nm.all_hosts():
        print("--------------------------------------------------------------------")
        print(f"Información para el dispositivo en la dirección IP: {host}")
        print("--------------------------------------------------------------------")

        # Obtener detalles adicionales del dispositivo
        nm.scan(hosts=host, arguments='-A -T4')

        # Imprimir detalles del dispositivo
        print(nm[host])

        # Puedes agregar más opciones de escaneo según sea necesario
        # nm.scan(hosts=host, arguments='-sV')  # Para obtener información de versiones de servicios
        # nm.scan(hosts=host, arguments='-p-')  # Para escanear todos los puertos del dispositivo

        print("--------------------------------------------------------------------\n")

# Obtener la dirección de la subred desde el usuario
subnet = input("Introduce la dirección de la subred (por ejemplo, 192.168.1): ")

# Llamar a la función para escanear la red y obtener información de los dispositivos
scan_network(subnet)
